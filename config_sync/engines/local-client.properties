# SymmetricDS Client Configuration for MySQL Local (Sucursal)
# ===============================================================================
# NOTA: Este archivo debe copiarse a cada sucursal y personalizar el external.id
# Comando de inicio: bin/sym_service -engine config_sync/engines/local-client.properties start

# Configuración del Motor
engine.name=local-client

# Configuración del Nodo (PERSONALIZAR POR SUCURSAL)
group.id=client
external.id=sucursal-<NUMERO_SUCURSAL>
sync.url=https://sync.<TU_DOMINIO>.com/sync/supabase-server

# Configuración de Base de Datos MySQL Local
db.driver=com.mysql.cj.jdbc.Driver
db.url=jdbc:mysql://localhost:3306/<NOMBRE_DB_LOCAL>?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
db.user=root
db.password=aps22

# Pool de Conexiones
db.pool.initial.size=3
db.pool.max.size=20
db.pool.min.idle=3
db.pool.max.idle=5
db.pool.max.wait=30000
db.pool.test.on.borrow=true
db.pool.test.on.return=false
db.pool.test.while.idle=true
db.pool.validation.query=select 1

# Auto-registro habilitado
auto.registration=true
registration.url=https://sync.<TU_DOMINIO>.com/sync/supabase-server/registration

# Jobs de sincronización
start.route.job=true
start.outgoing.batches.job=true
start.incoming.batches.job=true
start.statistics.job=true
start.synctriggers.job=true
start.push.job=true
start.pull.job=true
start.heartbeat.job=true
start.purge.job=true
start.offline.push.job=false
start.offline.pull.job=false

# Configuración de Jobs (frecuencias más rápidas para clientes)
job.routing.period.time.ms=3000
job.outgoing.batches.period.time.ms=3000
job.incoming.batches.period.time.ms=3000
job.push.period.time.ms=5000
job.pull.period.time.ms=5000
job.heartbeat.period.time.ms=30000
job.purge.period.time.ms=86400000

# Configuración de Lotes
outgoing.batch.max.bytes.to.sync=524288
incoming.batch.max.bytes.to.sync=524288
outgoing.batch.max.count.to.sync=500
incoming.batch.max.count.to.sync=500

# Configuración de Red
http.timeout.ms=180000
http.concurrent.connections.per.pool=5
http.header.accept.charset=UTF-8

# Configuración de Seguridad
security.verify.hostname=false
https.allow.self.signed.certs=true

# Configuración Web (opcional para clientes)
web.enable=false
web.http.port=8081

# Configuración de Log
log.level=INFO
console.log.level=INFO

# Configuración de Cache
cache.maximum.size=50000

# Configuración de Triggers
auto.config.database=false
auto.config.registration=false

# Configuración de Initial Load
initial.load.use.extract.job=true
initial.load.use.reload.channel=true
initial.load.extract.timeout.ms=3600000

# Configuración de Cluster (deshabilitado)
cluster.locking.enabled=false

# JMX para monitoreo local
jmx.agent.enable=true
jmx.agent.port=31417

# Configuración de transformaciones
transform.columns.enabled=true

# Configuración de archivos
sync.files.enabled=true
sync.files.max.size.bytes=5242880

# Configuración específica para MySQL
db.native.extractor=false
db.treats.binary.as.lob=false
db.stream.binary.data=true
db.use.capture.lobs=false

# Configuración de estadísticas
statistic.record.enable=true
statistic.capture.time.in.ms=60000

# Configuración de Dead Letter
dead.letter.sync.on.error=false

# Configuración de parámetros específicos del motor
symmetric.runtime.config.table.prefix=sym_
symmetric.runtime.stats.enable=true

# Configuración específica para sucursales
node.offline.incoming.dir=offline-incoming
node.offline.outgoing.dir=offline-outgoing
node.offline.archive.dir=offline-archive

# Configuración de retry para conexiones
http.basic.auth.retry.count=3
outgoing.batches.skip.duplicates=true
